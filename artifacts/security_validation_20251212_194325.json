{
  "timestamp": "2025-12-12T19:43:23.127739",
  "api_url": "http://127.0.0.1:8000",
  "total_tests": 4,
  "passed": 2,
  "warnings": 0,
  "failed": 2,
  "overall_status": "FAIL",
  "security_score": "50%",
  "test_results": [
    {
      "test": "authentication",
      "protected_endpoints": [
        {
          "endpoint": "/api/manual-seed",
          "status_code": 200,
          "result": "INSECURE (HTTP 200)",
          "secure": false
        },
        {
          "endpoint": "/api/admin",
          "status_code": 404,
          "result": "NOT FOUND (404)",
          "secure": null
        },
        {
          "endpoint": "/api/users",
          "status_code": 404,
          "result": "NOT FOUND (404)",
          "secure": null
        }
      ],
      "public_endpoints": [
        {
          "endpoint": "/api/occupancies",
          "status_code": 200,
          "accessible": true
        },
        {
          "endpoint": "/api/add-on-rates",
          "status_code": 200,
          "accessible": true
        },
        {
          "endpoint": "/api/add-on-master",
          "status_code": 200,
          "accessible": true
        }
      ],
      "status": "FAIL",
      "notes": [
        "1 protected endpoints are insecure"
      ]
    },
    {
      "test": "cors",
      "endpoints_tested": [
        {
          "endpoint": "/api/occupancies",
          "status_code": 200,
          "cors_header": "*",
          "cors_enabled": true
        },
        {
          "endpoint": "/api/add-on-rates",
          "status_code": 200,
          "cors_header": "*",
          "cors_enabled": true
        },
        {
          "endpoint": "/",
          "status_code": 200,
          "cors_header": "*",
          "cors_enabled": true
        }
      ],
      "cors_enabled": true,
      "allow_origin": "*",
      "status": "PASS",
      "notes": [
        "CORS is configured with Allow-Origin: *"
      ]
    },
    {
      "test": "sql_injection",
      "attacks_tested": [
        {
          "payload": "'; DROP TABLE add_on_master; --",
          "status_code": 200,
          "result": "SANITIZED (200 OK with valid data)",
          "protected": true
        },
        {
          "payload": "1' OR '1'='1",
          "status_code": 200,
          "result": "SANITIZED (200 OK with valid data)",
          "protected": true
        },
        {
          "payload": "admin'--",
          "status_code": 200,
          "result": "SANITIZED (200 OK with valid data)",
          "protected": true
        },
        {
          "payload": "' UNION SELECT NULL--",
          "status_code": 200,
          "result": "SANITIZED (200 OK with valid data)",
          "protected": true
        },
        {
          "payload": "1; DELETE FROM occupancies WHERE 1=1--",
          "status_code": 200,
          "result": "SANITIZED (200 OK with valid data)",
          "protected": true
        }
      ],
      "status": "PASS",
      "notes": [
        "No SQL injection vulnerabilities detected"
      ]
    },
    {
      "test": "rate_limiting",
      "global_limit_tested": false,
      "manual_seed_limit_tested": false,
      "status": "FAIL",
      "notes": [
        "Global rate limit NOT triggered after 65 requests"
      ]
    }
  ],
  "recommendations": [
    "1 protected endpoints are insecure",
    "Global rate limit NOT triggered after 65 requests"
  ]
}